Algassimou Pellel Diallo TP15

---------------- Question 1 (I)  ------------------
    nameserver 172.16.1.252
    nameserver 172.16.1.253
    
    Explication: 
        Cette commande affiche le contenu du fichier /etc/resolv.conf, qui liste les serveurs DNS 
        utilis√©s par le syst√®me. Cela permet de v√©rifier √† quelles adresses IP les requ√™tes DNS seront envoy√©es.

---------------- Question 2 (I)  ------------------
    [dialloa@vm-dialloa S2SCR]$ host 172.16.1.252
    252.1.16.172.in-addr.arpa domain name pointer ns3.iut-fbleau.fr.

    Explication:
        La commande host permet de faire une r√©solution inverse : elle prend une adresse IP et cherche
        le nom de domaine associ√© (s'il existe). Ici, on demande au syst√®me : " Quel est le nom associ√© 
        √† l'adresse IP du serveur DNS 172.16.1.252 ". Cela permet de v√©rifier si ce serveur DNS a bien un nom, 
        ce qui peut √™tre utile pour diagnostiquer ou comprendre l‚Äôorganisation du r√©seau.
        
---------------------- II ------------------------
---------------- Question 1 (II)  ------------------
    
    [dialloa@vm-dialloa ~]$ tshark -i enp6s18 -nlV -f "host 172.16.10.40 and host 172.16.1.252  and not arp" | tee traceDNS.log

    Explication: 
    La commande tshark capture le trafic r√©seau sur l'interface enp6s18 entre la machine
    locale (172.16.10.40) et le serveur DNS (172.16.1.252), en ignorant les paquets ARP.
    Le r√©sultat montre les d√©tails du paquet DNS, comme l'adresse source/destination, les ports UDP, et les donn√©es DNS.
    Le fichier traceDNS.log garde une copie compl√®te de cette trace.


---------------- Question 2 (II)  ------------------

    [dialloa@vm-dialloa ~]$ dig iluvatar.arda.lan
    
    Queries
        iluvatar.arda.lan: type A, class IN
            Name: iluvatar.arda.lan
            [Name Length: 17]
            [Label Count: 3]
            Type: A (1) (Host Address)
            Class: IN (0x0001)
    Answers
        iluvatar.arda.lan: type A, class IN, addr 172.16.1.30
            Name: iluvatar.arda.lan
            Type: A (1) (Host Address)
            Class: IN (0x0001)
            Time to live: 3600 (1 hour)
            Data length: 4
            Address: 172.16.1.30

    Pour voir +, verifie le fichier traceDNS.log
   

---------------- Question 3 (II)  ------------------
    Explication: En analysant le r√©sultat de la commande dig iluvatar.arda.lan, 
    si l‚Äôon observe la frame 2 dans la section Domain Name System (response) puis Answers, 
    on y trouve une ligne indiquant le type A.
    Cela signifie que le serveur a renvoy√© l‚Äôadresse IPv4 correspondant au nom iluvatar.arda.lan, 
    soit : iluvatar.arda.lan: type A, class IN, addr 172.16.1.30.

---------------- Question 4 (II)  ------------------
    Transaction ID: 0x7582
    Flags: 0x8580 Standard query response, No error
        1... .... .... .... = Response: Message is a response
        .000 0... .... .... = Opcode: Standard query (0)
        .... .1.. .... .... = Authoritative: Server is an authority for domain
        .... ..0. .... .... = Truncated: Message is not truncated
        .... ...1 .... .... = Recursion desired: Do query recursively
        .... .... 1... .... = Recursion available: Server can do recursive queries
        .... .... .0.. .... = Z: reserved (0)
        .... .... ..0. .... = Answer authenticated: Answer/authority portion was not authenticated by the server
        .... .... ...0 .... = Non-authenticated data: Unacceptable
        .... .... .... 0000 = Reply code: No error (0)
    Questions: 1
    Answer RRs: 1
    Authority RRs: 0
    Additional RRs: 1
    Pour voir +, verifie le fichier traceDNS.log

    Explication: 
        Dans la section header de la r√©ponse dig, on trouve plusieurs informations importantes :

    Transaction ID: 0x7582 : identifiant de la requ√™te DNS.

    Flags: 0x8580 indique plusieurs choses :

        qr = 1 c‚Äôest une r√©ponse (pas une requ√™te),

        aa = 1 le serveur est autoritaire pour le domaine demand√©,

        rd = 1 la r√©cursivit√© √©tait demand√©e,

        ra = 1 le serveur accepte les requ√™tes r√©cursives,

        rcode = 0 pas d‚Äôerreur.


---------------- Question 5 (II)  ------------------

Explication:  
    Dans la sortie de la commande dig, on peut voir la ligne suivante :
    ;; flags: qr aa rd ra;
    Le flag aa (Authoritative Answer) indique que le serveur est autoritaire 
    pour le nom de domaine iluvatar.arda.lan. Cela signifie que le serveur poss√®de directement
    l‚Äôinformation et ne l‚Äôa pas obtenue via une autre source ou par cache.


---------------- Question 6 (II)  ------------------

    Answers
        iluvatar.arda.lan: type A, class IN, addr 172.16.1.30
            Name: iluvatar.arda.lan
            Type: A (1) (Host Address)
            Class: IN (0x0001)
            Time to live: 3600 (1 hour)
            Data length: 4
            Address: 172.16.1.30

    Explication: 
        Dans la section Answers de la frame 2, on voit que le champ Time to live (TTL)
        est √©gal √† 3600 secondes (soit 1 heure). Ce TTL indique la dur√©e pendant laquelle
        l‚Äôadresse IP 172.16.1.30 peut rester en cache dans le DNS local (172.16.1.252),
        sans refaire de requ√™te.
        Cela permet :
            d‚Äôacc√©l√©rer les prochaines r√©solutions,
            d‚Äô√©viter de surcharger les serveurs DNS avec les m√™mes questions r√©p√©t√©es.

---------------- Question 7 (II)  -----------------------
    tcpdump -i enp6s18 -n -vvv port 53 and host 172.16.1.252 -w tcpdumpDNS.log

    Explication: 
        Cette commande capture le trafic DNS (port 53) entre ta machine et le serveur 172.16.1.252, via tcpdump.log
        Les options :

            -i enp6s18 : interface r√©seau,

            -n : pas de r√©solution de noms,

            -vvv : affichage tr√®s d√©taill√©,

            -w traceTCPDNS.log : sauvegarde dans un fichier log pour analyse.

---------------- Question 7 (II)  ----------------------
    tcpdump -i enp6s18 -n -vvv port 53 and host 172.16.1.252 -w traceTCPDNS.pcap

    Explication :
    Cette commande capture le trafic DNS (port 53) entre ta machine et le serveur 172.16.1.252, via tcpdump.
    Les options :

    -i enp6s18 : interface r√©seau,

    -n : pas de r√©solution de noms,

    -vvv : affichage tr√®s d√©taill√©,

    -w traceTCPDNS.pcap : sauvegarde dans un fichier .pcap pour analyse avec Wireshark.
    Dans ce fichier, on pourra retrouver les m√™mes infos que dans tshark : type de requ√™te, adresse IP, TTL, flags, etc.

---------------- Question 8 (II)  ----------------------
dig arda.com

Explication :
Quand on interroge arda.com avec dig, on refait comme pour iluvatar.arda.lan les questions 1, 2 et 5.
Mais cette fois, dans le header, on remarque que le flag aa n‚Äôest pas pr√©sent.
Diff√©rence principale :

    Pour iluvatar.arda.lan, le serveur est autoritaire ‚Üí flag aa pr√©sent.

    Pour arda.com, le serveur n‚Äôest pas autoritaire ‚Üí flag aa absent.

Cela signifie que le serveur DNS a d√ª obtenir la r√©ponse via un autre serveur (r√©solution r√©cursive).

----------------   (III)  ----------------------
------------ Question 1 (III) ----------------------
Question 1 (III)

dig vintage.com

Explication :
Quand tu ex√©cutes dig vintage.com, tu verras dans la section Answer un champ TTL (Time To Live), par exemple :

vintage.com.  3210  IN  A  93.184.216.34

Le nombre 3210 correspond au temps (en secondes) pendant lequel cette information reste valide en cache.

üëâ Si tu relances dig juste apr√®s, tu remarqueras que le TTL a diminu√© (ex. : 3197), ce qui signifie que la donn√©e a √©t√© r√©cup√©r√©e depuis le cache local.

Conclusion :
Le TTL diminue √† chaque seconde, ce qui montre que la r√©ponse est en cache et qu‚Äôelle expire progressivement.
üîπ Question 2 (III)

dig iluvatar.arda.lan

Explication :
Lorsque tu interroges iluvatar.arda.lan plusieurs fois, tu peux remarquer deux comportements :

    Cas 1 : Si la r√©ponse vient du cache local, le TTL diminue comme dans l'exemple pr√©c√©dent.

    Cas 2 : Si le serveur est autoritaire et redonne la r√©ponse √† chaque fois, le TTL est r√©initialis√© (ex. : toujours 3600).

Conclusion :
Pour un domaine comme iluvatar.arda.lan, si le TTL reste constant √† chaque requ√™te, c‚Äôest que le resolver refait la requ√™te au serveur √† chaque fois, donc pas de cache utilis√©.
üîπ Question 3 (III)

R√©ponse :
Oui, il est possible de forcer une requ√™te DNS √† ignorer le cache.

Pour cela, on utilise l‚Äôoption suivante dans dig :

dig +norecurse

Mais attention :

    Cela emp√™che l'utilisation de la r√©solution r√©cursive, donc le serveur contact√© ne va pas interroger d'autres serveurs si l'info n‚Äôest pas en cache ou dans sa zone.

    Le RFC 1035 (sp√©cification DNS) n‚Äôinterdit pas de forcer ou ignorer le cache, mais c‚Äôest au client ou au serveur de choisir selon les options envoy√©es (comme +norecurse ou +nocache avec certains outils).



note:
le fai que le serveur a l'hautorit√© est indique par la flag aa 

la section hautorit√© le 0 est juste le nombre de ligne dans cette section

